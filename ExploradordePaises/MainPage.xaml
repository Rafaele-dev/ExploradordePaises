<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="ExploradordePaises.MainPage"
    Title="Explorador de Países"
    BackgroundColor="#1E1E1E">

    <Grid RowDefinitions="Auto,*" Padding="10">

        <Frame 
            Grid.Row="0"
            BackgroundColor="#2D2D30" 
            HasShadow="True"
            CornerRadius="10"
            Padding="15"
            Margin="0,0,0,10">

            <StackLayout Spacing="10">
                <Entry 
                    x:Name="SearchEntry"
                    Placeholder="Buscar países..."
                    PlaceholderColor="#B0B0B0"
                    TextColor="#FFFFFF"
                    BackgroundColor="#1E1E1E"
                    FontSize="16"
                    TextChanged="OnSearchTextChanged"/>

            </StackLayout>
        </Frame>

        <CollectionView
            Grid.Row="1"
            ItemsSource="{Binding PaisesFiltrados}"
            SelectionMode="Single"
            SelectionChanged="OnSelectionChanged"
            VerticalOptions="FillAndExpand"
            BackgroundColor="Transparent">

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame 
                        BackgroundColor="#2D2D30"
                        HasShadow="True"
                        CornerRadius="10"
                        Padding="15"
                        Margin="0,5">

                        <Grid 
                            ColumnDefinitions="60,*"
                            RowDefinitions="Auto,Auto"
                            BackgroundColor="Transparent">

                            <Frame 
                                Grid.Column="0" 
                                Grid.RowSpan="2"
                                BackgroundColor="#404040"
                                HasShadow="False"
                                CornerRadius="5"
                                Padding="2"
                                WidthRequest="50"
                                HeightRequest="35"
                                VerticalOptions="Center">

                                <Image 
                                    Source="{Binding Flags.Png}" 
                                    Aspect="AspectFill"/>
                            </Frame>

                            <Label 
                                Grid.Column="1" 
                                Grid.Row="0"
                                Text="{Binding Name.Common}" 
                                FontAttributes="Bold" 
                                FontSize="16"
                                TextColor="#FFFFFF"
                                VerticalOptions="Center"
                                Margin="10,0,0,0"/>

                            <StackLayout 
                                Grid.Column="1" 
                                Grid.Row="1"
                                Orientation="Horizontal"
                                Margin="10,5,0,0">

                                <Label 
                                    Text="{Binding CapitalDisplay}" 
                                    FontSize="14" 
                                    TextColor="#B0B0B0"
                                    VerticalOptions="Center"/>

                                <Label 
                                    Text=" • " 
                                    FontSize="14" 
                                    TextColor="#B0B0B0"
                                    VerticalOptions="Center"/>

                                <Label 
                                    Text="{Binding Region}" 
                                    FontSize="14" 
                                    TextColor="#B0B0B0"
                                    VerticalOptions="Center"/>
                            </StackLayout>

                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>

    </Grid>

</ContentPage>